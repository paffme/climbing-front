/* const allData = {
  "microbe": {
    "female": {
      "QUALIFIER": {
        "id": 0,
        "competitionId": 0,
        "name": 0,
        "quota": 0,
        "type": "CIRCUIT",
        "sex": "male",
        "category": "microbe",
        "state": "PENDING",
        "maxTries": 0
      },
      "SEMI_FINAL": {
        "id": 0,
        "competitionId": 0,
        "name": 0,
        "quota": 0,
        "type": "CIRCUIT",
        "sex": "male",
        "category": "microbe",
        "state": "PENDING",
        "maxTries": 0
      },
      "FINAL": {
        "id": 0,
        "competitionId": 0,
        "name": 0,
        "quota": 0,
        "type": "CIRCUIT",
        "sex": "male",
        "category": "microbe",
        "state": "PENDING",
        "maxTries": 0
      }
    },
    "male": {
      "QUALIFIER": {
        "id": 0,
        "competitionId": 0,
        "name": 0,
        "quota": 0,
        "type": "CIRCUIT",
        "sex": "male",
        "category": "microbe",
        "state": "PENDING",
        "maxTries": 0
      },
      "SEMI_FINAL": {
        "id": 0,
        "competitionId": 0,
        "name": 0,
        "quota": 0,
        "type": "CIRCUIT",
        "sex": "male",
        "category": "microbe",
        "state": "PENDING",
        "maxTries": 0
      },
      "FINAL": {
        "id": 0,
        "competitionId": 0,
        "name": 0,
        "quota": 0,
        "type": "CIRCUIT",
        "sex": "male",
        "category": "microbe",
        "state": "PENDING",
        "maxTries": 0
      }
    }
  },
  "poussin": {
    "female": {
      "QUALIFIER": {
        "id": 0,
        "competitionId": 0,
        "name": 0,
        "quota": 0,
        "type": "CIRCUIT",
        "sex": "male",
        "category": "microbe",
        "state": "PENDING",
        "maxTries": 0
      },
      "SEMI_FINAL": {
        "id": 0,
        "competitionId": 0,
        "name": 0,
        "quota": 0,
        "type": "CIRCUIT",
        "sex": "male",
        "category": "microbe",
        "state": "PENDING",
        "maxTries": 0
      },
      "FINAL": {
        "id": 0,
        "competitionId": 0,
        "name": 0,
        "quota": 0,
        "type": "CIRCUIT",
        "sex": "male",
        "category": "microbe",
        "state": "PENDING",
        "maxTries": 0
      }
    },
    "male": {
      "QUALIFIER": {
        "id": 0,
        "competitionId": 0,
        "name": 0,
        "quota": 0,
        "type": "CIRCUIT",
        "sex": "male",
        "category": "microbe",
        "state": "PENDING",
        "maxTries": 0
      },
      "SEMI_FINAL": {
        "id": 0,
        "competitionId": 0,
        "name": 0,
        "quota": 0,
        "type": "CIRCUIT",
        "sex": "male",
        "category": "microbe",
        "state": "PENDING",
        "maxTries": 0
      },
      "FINAL": {
        "id": 0,
        "competitionId": 0,
        "name": 0,
        "quota": 0,
        "type": "CIRCUIT",
        "sex": "male",
        "category": "microbe",
        "state": "PENDING",
        "maxTries": 0
      }
    }
  },
  "benjamin": {
    "female": {
      "QUALIFIER": {
        "id": 0,
        "competitionId": 0,
        "name": 0,
        "quota": 0,
        "type": "CIRCUIT",
        "sex": "male",
        "category": "microbe",
        "state": "PENDING",
        "maxTries": 0
      },
      "SEMI_FINAL": {
        "id": 0,
        "competitionId": 0,
        "name": 0,
        "quota": 0,
        "type": "CIRCUIT",
        "sex": "male",
        "category": "microbe",
        "state": "PENDING",
        "maxTries": 0
      },
      "FINAL": {
        "id": 0,
        "competitionId": 0,
        "name": 0,
        "quota": 0,
        "type": "CIRCUIT",
        "sex": "male",
        "category": "microbe",
        "state": "PENDING",
        "maxTries": 0
      }
    },
    "male": {
      "QUALIFIER": {
        "id": 0,
        "competitionId": 0,
        "name": 0,
        "quota": 0,
        "type": "CIRCUIT",
        "sex": "male",
        "category": "microbe",
        "state": "PENDING",
        "maxTries": 0
      },
      "SEMI_FINAL": {
        "id": 0,
        "competitionId": 0,
        "name": 0,
        "quota": 0,
        "type": "CIRCUIT",
        "sex": "male",
        "category": "microbe",
        "state": "PENDING",
        "maxTries": 0
      },
      "FINAL": {
        "id": 0,
        "competitionId": 0,
        "name": 0,
        "quota": 0,
        "type": "CIRCUIT",
        "sex": "male",
        "category": "microbe",
        "state": "PENDING",
        "maxTries": 0
      }
    }
  },
  "minime": {
    "female": {
      "QUALIFIER": {
        "id": 0,
        "competitionId": 0,
        "name": 0,
        "quota": 0,
        "type": "CIRCUIT",
        "sex": "male",
        "category": "microbe",
        "state": "PENDING",
        "maxTries": 0
      },
      "SEMI_FINAL": {
        "id": 0,
        "competitionId": 0,
        "name": 0,
        "quota": 0,
        "type": "CIRCUIT",
        "sex": "male",
        "category": "microbe",
        "state": "PENDING",
        "maxTries": 0
      },
      "FINAL": {
        "id": 0,
        "competitionId": 0,
        "name": 0,
        "quota": 0,
        "type": "CIRCUIT",
        "sex": "male",
        "category": "microbe",
        "state": "PENDING",
        "maxTries": 0
      }
    },
    "male": {
      "QUALIFIER": {
        "id": 0,
        "competitionId": 0,
        "name": 0,
        "quota": 0,
        "type": "CIRCUIT",
        "sex": "male",
        "category": "microbe",
        "state": "PENDING",
        "maxTries": 0
      },
      "SEMI_FINAL": {
        "id": 0,
        "competitionId": 0,
        "name": 0,
        "quota": 0,
        "type": "CIRCUIT",
        "sex": "male",
        "category": "microbe",
        "state": "PENDING",
        "maxTries": 0
      },
      "FINAL": {
        "id": 0,
        "competitionId": 0,
        "name": 0,
        "quota": 0,
        "type": "CIRCUIT",
        "sex": "male",
        "category": "microbe",
        "state": "PENDING",
        "maxTries": 0
      }
    }
  },
  "cadet": {
    "female": {
      "QUALIFIER": {
        "id": 0,
        "competitionId": 0,
        "name": 0,
        "quota": 0,
        "type": "CIRCUIT",
        "sex": "male",
        "category": "microbe",
        "state": "PENDING",
        "maxTries": 0
      },
      "SEMI_FINAL": {
        "id": 0,
        "competitionId": 0,
        "name": 0,
        "quota": 0,
        "type": "CIRCUIT",
        "sex": "male",
        "category": "microbe",
        "state": "PENDING",
        "maxTries": 0
      },
      "FINAL": {
        "id": 0,
        "competitionId": 0,
        "name": 0,
        "quota": 0,
        "type": "CIRCUIT",
        "sex": "male",
        "category": "microbe",
        "state": "PENDING",
        "maxTries": 0
      }
    },
    "male": {
      "QUALIFIER": {
        "id": 0,
        "competitionId": 0,
        "name": 0,
        "quota": 0,
        "type": "CIRCUIT",
        "sex": "male",
        "category": "microbe",
        "state": "PENDING",
        "maxTries": 0
      },
      "SEMI_FINAL": {
        "id": 0,
        "competitionId": 0,
        "name": 0,
        "quota": 0,
        "type": "CIRCUIT",
        "sex": "male",
        "category": "microbe",
        "state": "PENDING",
        "maxTries": 0
      },
      "FINAL": {
        "id": 0,
        "competitionId": 0,
        "name": 0,
        "quota": 0,
        "type": "CIRCUIT",
        "sex": "male",
        "category": "microbe",
        "state": "PENDING",
        "maxTries": 0
      }
    }
  },
  "junior": {
    "female": {
      "QUALIFIER": {
        "id": 0,
        "competitionId": 0,
        "name": 0,
        "quota": 0,
        "type": "CIRCUIT",
        "sex": "male",
        "category": "microbe",
        "state": "PENDING",
        "maxTries": 0
      },
      "SEMI_FINAL": {
        "id": 0,
        "competitionId": 0,
        "name": 0,
        "quota": 0,
        "type": "CIRCUIT",
        "sex": "male",
        "category": "microbe",
        "state": "PENDING",
        "maxTries": 0
      },
      "FINAL": {
        "id": 0,
        "competitionId": 0,
        "name": 0,
        "quota": 0,
        "type": "CIRCUIT",
        "sex": "male",
        "category": "microbe",
        "state": "PENDING",
        "maxTries": 0
      }
    },
    "male": {
      "QUALIFIER": {
        "id": 0,
        "competitionId": 0,
        "name": 0,
        "quota": 0,
        "type": "CIRCUIT",
        "sex": "male",
        "category": "microbe",
        "state": "PENDING",
        "maxTries": 0
      },
      "SEMI_FINAL": {
        "id": 0,
        "competitionId": 0,
        "name": 0,
        "quota": 0,
        "type": "CIRCUIT",
        "sex": "male",
        "category": "microbe",
        "state": "PENDING",
        "maxTries": 0
      },
      "FINAL": {
        "id": 0,
        "competitionId": 0,
        "name": 0,
        "quota": 0,
        "type": "CIRCUIT",
        "sex": "male",
        "category": "microbe",
        "state": "PENDING",
        "maxTries": 0
      }
    }
  },
  "senior": {
    "female": {
      "QUALIFIER": {
        "id": 0,
        "competitionId": 0,
        "name": 0,
        "quota": 0,
        "type": "CIRCUIT",
        "sex": "male",
        "category": "microbe",
        "state": "PENDING",
        "maxTries": 0
      },
      "SEMI_FINAL": {
        "id": 0,
        "competitionId": 0,
        "name": 0,
        "quota": 0,
        "type": "CIRCUIT",
        "sex": "male",
        "category": "microbe",
        "state": "PENDING",
        "maxTries": 0
      },
      "FINAL": {
        "id": 0,
        "competitionId": 0,
        "name": 0,
        "quota": 0,
        "type": "CIRCUIT",
        "sex": "male",
        "category": "microbe",
        "state": "PENDING",
        "maxTries": 0
      }
    },
    "male": {
      "QUALIFIER": {
        "id": 0,
        "competitionId": 0,
        "name": 0,
        "quota": 0,
        "type": "CIRCUIT",
        "sex": "male",
        "category": "microbe",
        "state": "PENDING",
        "maxTries": 0
      },
      "SEMI_FINAL": {
        "id": 0,
        "competitionId": 0,
        "name": 0,
        "quota": 0,
        "type": "CIRCUIT",
        "sex": "male",
        "category": "microbe",
        "state": "PENDING",
        "maxTries": 0
      },
      "FINAL": {
        "id": 0,
        "competitionId": 0,
        "name": 0,
        "quota": 0,
        "type": "CIRCUIT",
        "sex": "male",
        "category": "microbe",
        "state": "PENDING",
        "maxTries": 0
      }
    }
  },
  "veteran": {
    "female": {
      "QUALIFIER": {
        "id": 0,
        "competitionId": 0,
        "name": 0,
        "quota": 0,
        "type": "CIRCUIT",
        "sex": "male",
        "category": "microbe",
        "state": "PENDING",
        "maxTries": 0
      },
      "SEMI_FINAL": {
        "id": 0,
        "competitionId": 0,
        "name": 0,
        "quota": 0,
        "type": "CIRCUIT",
        "sex": "male",
        "category": "microbe",
        "state": "PENDING",
        "maxTries": 0
      },
      "FINAL": {
        "id": 0,
        "competitionId": 0,
        "name": 0,
        "quota": 0,
        "type": "CIRCUIT",
        "sex": "male",
        "category": "microbe",
        "state": "PENDING",
        "maxTries": 0
      }
    },
    "male": {
      "QUALIFIER": {
        "id": 0,
        "competitionId": 0,
        "name": 0,
        "quota": 0,
        "type": "CIRCUIT",
        "sex": "male",
        "category": "microbe",
        "state": "PENDING",
        "maxTries": 0
      },
      "SEMI_FINAL": {
        "id": 0,
        "competitionId": 0,
        "name": 0,
        "quota": 0,
        "type": "CIRCUIT",
        "sex": "male",
        "category": "microbe",
        "state": "PENDING",
        "maxTries": 0
      },
      "FINAL": {
        "id": 0,
        "competitionId": 0,
        "name": 0,
        "quota": 0,
        "type": "CIRCUIT",
        "sex": "male",
        "category": "microbe",
        "state": "PENDING",
        "maxTries": 0
      }
    }
  }
} */

const limitedData = {
  minime: {
    female: {
      QUALIFIER: {
        id: 0,
        competitionId: 0,
        name: 0,
        quota: 0,
        type: 'CIRCUIT',
        sex: 'male',
        category: 'microbe',
        state: 'PENDING',
        maxTries: 0
      },
      SEMI_FINAL: {
        id: 0,
        competitionId: 0,
        name: 0,
        quota: 0,
        type: 'CIRCUIT',
        sex: 'male',
        category: 'microbe',
        state: 'PENDING',
        maxTries: 0
      },
      FINAL: {
        id: 0,
        competitionId: 0,
        name: 0,
        quota: 0,
        type: 'CIRCUIT',
        sex: 'male',
        category: 'microbe',
        state: 'PENDING',
        maxTries: 0
      }
    },
    male: {
      QUALIFIER: {
        id: 0,
        competitionId: 0,
        name: 0,
        quota: 0,
        type: 'CIRCUIT',
        sex: 'male',
        category: 'microbe',
        state: 'PENDING',
        maxTries: 0
      },
      SEMI_FINAL: {
        id: 0,
        competitionId: 0,
        name: 0,
        quota: 0,
        type: 'CIRCUIT',
        sex: 'male',
        category: 'microbe',
        state: 'PENDING',
        maxTries: 0
      },
      FINAL: {
        id: 0,
        competitionId: 0,
        name: 0,
        quota: 0,
        type: 'CIRCUIT',
        sex: 'male',
        category: 'microbe',
        state: 'PENDING',
        maxTries: 0
      }
    }
  },
  poussin: {
    female: {
      QUALIFIER: {
        id: 0,
        competitionId: 0,
        name: 0,
        quota: 0,
        type: 'CIRCUIT',
        sex: 'male',
        category: 'microbe',
        state: 'PENDING',
        maxTries: 0
      },
      SEMI_FINAL: {
        id: 0,
        competitionId: 0,
        name: 0,
        quota: 0,
        type: 'CIRCUIT',
        sex: 'male',
        category: 'microbe',
        state: 'PENDING',
        maxTries: 0
      },
      FINAL: {
        id: 0,
        competitionId: 0,
        name: 0,
        quota: 0,
        type: 'CIRCUIT',
        sex: 'male',
        category: 'microbe',
        state: 'PENDING',
        maxTries: 0
      }
    }
  },
  senior: {},
  cadet: {
    female: {}
  }
}

function extractCategoryGenre(data) {
  if (!data) return []
  const final = []
  for (const [key, value] of Object.entries(data)) {
    const haveFemaleCategory =
      value.female && Object.keys(value.female).length !== 0
    const haveMaleCategory = value.male && Object.keys(value.male).length !== 0

    if (!haveFemaleCategory && !haveMaleCategory) continue

    const temp = [{ genre: [] }]

    if (haveFemaleCategory) {
      temp[0].genre.push('femme')
    }
    if (haveMaleCategory) {
      temp[0].genre.push('homme')
    }

    temp[0].category = key
    final.push(temp)
  }

  return final
}

describe('TransformFunction', () => {
  it('Should extract all Categories and Genre', () => {
    const result = [
      [{ genre: ['femme', 'homme'], category: 'minime' }],
      [{ genre: ['femme'], category: 'poussin' }]
    ]
    expect(extractCategoryGenre(limitedData)).toEqual(result)
  })

  it('Should return an empty array if no catgory is set', () => {
    expect(extractCategoryGenre(undefined)).toEqual([])
    expect(extractCategoryGenre({})).toEqual([])
  })
})
